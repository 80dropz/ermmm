<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Get Your Key</title>
    <script src="https://publisher.linkvertise.com/cdn/linkvertise.js"></script>
    <style>
        /* Your existing CSS styles */
        body { background-color: #121212; color: #ffffff; font-family: Arial, sans-serif; margin: 0; padding: 20px; text-align: center; }
        h1 { color: #bb86fc; font-size: 24px; margin-bottom: 10px; }
        .terms { font-size: 14px; color: #a0a0a0; margin-bottom: 20px; }
        button { background-color: #bb86fc; color: #121212; border: none; padding: 10px 20px; font-size: 16px; cursor: pointer; border-radius: 5px; transition: background-color 0.3s ease; margin-bottom: 20px; }
        button:hover { background-color: #9a67ea; }
        #key-display { margin-top: 20px; padding: 10px; background-color: #1e1e1e; border-radius: 5px; color: #ffffff; font-size: 18px; }
    </style>
    <script>
        // Obfuscated keys (base64 encoded)
        const encodedKeys = [
            'a2V5MS1hYmMxMjM=',
            'a2V5Mi1kZWY0NTY=',
            'a2V5My1naGk3ODk='
        ];
        let keys = encodedKeys.map(k => atob(k));
        let usedHashes = [];

        function getRandomKey() {
            if(keys.length === 0) return null;
            const randomIndex = Math.floor(Math.random() * keys.length);
            return keys.splice(randomIndex, 1)[0];
        }

        async function validateHash(hash) {
            try {
                // Use CORS proxy to bypass restrictions
                const response = await fetch(`https://cors-anywhere.herokuapp.com/https://publisher.linkvertise.com/api/v1/redirect/link/check/${hash}`, {
                    headers: {
                        'User-Agent': 'Mozilla/5.0',
                        'X-Requested-With': 'XMLHttpRequest'
                    }
                });
                
                const data = await response.json();
                return data.data?.valid === true;
            } catch (error) {
                console.error('Validation error:', error);
                return false;
            }
        }

        async function checkInitialHash() {
            const urlParams = new URLSearchParams(window.location.search);
            const hash = urlParams.get('hash');
            
            if(hash && !usedHashes.includes(hash)) {
                const isValid = await validateHash(hash);
                if(isValid) {
                    const key = getRandomKey();
                    document.getElementById("key-display").innerHTML = key ? 
                        `Your key is: <strong>${key}</strong>` : 
                        "No more keys available!";
                    usedHashes.push(hash);
                } else {
                    document.getElementById("key-display").innerHTML = "Invalid or expired offer!";
                }
            }
        }

        function initializeLinkvertise() {
            linkvertise(1196977, {
                onSuccess: () => {
                    const uniqueHash = Date.now().toString(36) + Math.random().toString(36).substr(2);
                    window.location.href = `${window.location.origin}?hash=${uniqueHash}`;
                },
                onFailure: () => {
                    document.getElementById("key-display").innerHTML = "Please complete the offer!";
                }
            });
        }

        window.onload = () => {
            checkInitialHash();
            
            if(typeof linkvertise === 'function') {
                initializeLinkvertise();
            } else {
                document.getElementById("key-display").innerHTML = "Please disable ad blockers!";
            }
        };
    </script>
</head>
<body>
    <h1>Complete the Offer to Get Your Key</h1>
    <div class="terms">
        By using this key you agree to our Terms of Service.<br>
        This key is single-use and personally assigned!
    </div>
    <button onclick="window.open('https://link-target.net/1196977/freerustrefined', '_blank')">
        Get Your Key Now
    </button>
    <div id="key-display">Click the button to start</div>
</body>
</html>
